

ğŸŸ¦ å…ˆè¯´ç»“è®º
å¦‚æœä½ çš„ UID æ˜¯å¤©ç„¶è¿ç»­çš„ã€å¯æ§çš„ã€ä¸ä¼šè¿ç§»çš„ â†’ ç”¨ UID èŒƒå›´è§„åˆ™æœ€ç®€å•ã€‚
å¦‚æœä½ çš„ UID å¯èƒ½è¿ç§»ã€æ‰©å®¹ã€ç¼©å®¹ã€å†·çƒ­åˆ†å¸ƒä¸å‡ â†’ å¿…é¡»ç”¨ shard_mapã€‚
ä½ ç°åœ¨çš„æƒ³æ³•ï¼š

â€œç”¨ uid èŒƒå›´è§„åˆ™å°±è¡Œï¼Œä¸ç”¨ shard_map è¡¨â€

åœ¨å¾ˆå¤šä¸šåŠ¡é‡Œç¡®å®æ›´ç®€å•ã€æ›´é«˜æ•ˆã€‚


ğŸŸ© æ–¹æ¡ˆ Aï¼šUID èŒƒå›´è§„åˆ™ï¼ˆé…ç½®æ–‡ä»¶ï¼‰
ä¼˜ç‚¹ï¼š

æå…¶ç®€å•ï¼ˆä¸€ä¸ª JSON é…ç½®å°±æå®šï¼‰

ä¸éœ€è¦æ•°æ®åº“æŸ¥è¯¢

æ€§èƒ½æé«˜

æ— å¹¶å‘é—®é¢˜

éƒ¨ç½²ç®€å•

ä¾‹å¦‚ï¼š

json
{
"shards": [
{ "range": [0, 999999], "node": "10.0.0.1", "table": "user_0" },
{ "range": [1000000, 1999999], "node": "10.0.0.2", "table": "user_1" }
]




è·¯ç”±å‡½æ•°ï¼š

ts
function route(uid: number) {
for (const s of config.shards) {
if (uid >= s.range[0] && uid <= s.range[1]) {
return s;
}
}
}