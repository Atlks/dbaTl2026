
mysql vs mssql
innodb_flush_log_at_trx_commit	控制日志刷盘频率	delayed durability（延迟持久化）	✔（可选）

innodb_io_capacity	后台刷盘速度	checkpoint / indirect checkpoint	✔
innodb_max_dirty_pages_pct	脏页比例阈值	target recovery time（间接控制 checkpoint 频率）	✔



innodb_flush_log_at_trx_commit	delayed durability	控制日志刷盘频率
innodb_io_capacity	indirect checkpoint	控制后台刷盘速度
innodb_max_dirty_pages_pct	target recovery time	控制脏页比例


ALTER DATABASE YourDB SET TARGET_RECOVERY_TIME = 300 SECONDS;




ALTER DATABASE hxpay
SET DELAYED_DURABILITY = FORCED;

delayed_durability_desc 会显示：

值	含义
DISABLED	禁用（默认）
ALLOWED	允许，但需要在事务级别指定
FORCED	所有事务都使用延迟持久化（最高性能）

他这个延迟可以控制延迟时间吗？
不行，Delayed Durability 在 SQL Server 里不能控制“延迟多久”。
它不是一个“可配置延迟时间”的机制，而是一个异步日志 flush 行为：事务提交后，日志记录会被放在内存里，由 SQL Server 自己决定何时 flush 到磁盘。

换句话说：

你 不能设置延迟 10ms、50ms、100ms

你 不能控制 flush 周期

你 不能控制批量大小

SQL Server 完全自行调度（基于内部 flush 策略、内存压力、日志缓冲区状态等）



# checkpoint
📊 对比：AUTO vs 300 秒
项目	AUTO（默认）	300 秒
CHECKPOINT 频率	较频繁	较少
写 IO 压力	较高	较低
写入吞吐	较低	较高
崩溃恢复时间	通常几十秒	可能更长（但不一定到 5 分钟）
适合场景	普通 OLTP	



TARGET_RECOVERY_TIME：提升 5%–20%（主要减少 CHECKPOINT 干扰）
Delayed Durability：提升 20%–200%（减少 WRITELOG 等待）