

SQL Server è¦æŸ¥è¯¢å¦ä¸€å°æœºå™¨ä¸Šçš„æ•°æ®åº“ï¼Œå¿…é¡»é€šè¿‡ é“¾æ¥æœåŠ¡å™¨ï¼ˆLinked Serverï¼‰ æˆ– OPENROWSET æ¥å®ç°ã€‚

ä¸‹é¢æˆ‘ç»™ä½ è®²å¾—éå¸¸æ¸…æ¥šã€‚

ğŸ¥‡ æ–¹å¼ 1ï¼šä½¿ç”¨ Linked Serverï¼ˆæœ€å¸¸ç”¨ã€æœ€ç¨³å®šï¼‰
ä½ å…ˆåœ¨æœ¬æœºåˆ›å»ºä¸€ä¸ªé“¾æ¥æœåŠ¡å™¨ï¼š

sql
EXEC sp_addlinkedserver
@server = 'SrvA',
@srvproduct = '',
@provider = 'SQLNCLI',
@datasrc = '192.168.1.1,1345';   -- IP + ç«¯å£
å†é…ç½®ç™»å½•æ˜ å°„ï¼š

sql
EXEC sp_addlinkedsrvlogin
@rmtsrvname = 'SrvA',
@useself = 'false',
@locallogin = NULL,
@rmtuser = 'sa',
@rmtpassword = 'yourpassword';
ç„¶åä½ å°±å¯ä»¥è¿™æ ·æŸ¥è¯¢ï¼š

sql
SELECT *
FROM SrvA.database1.dbo.table1;
è¿™å°±æ˜¯ SQL Server æ­£è§„çš„è·¨æœºå™¨æŸ¥è¯¢æ–¹å¼ã€‚

ğŸ¥ˆ æ–¹å¼ 2ï¼šä½¿ç”¨ OPENQUERYï¼ˆé€‚åˆå¤æ‚ SQLï¼‰
sql
SELECT *
FROM OPENQUERY(SrvA, 'SELECT * FROM database1.dbo.table1');
é€‚åˆè·¨åº“ JOINã€åˆ†é¡µç­‰å¤æ‚ SQLã€‚

ğŸ¥‰ æ–¹å¼ 3ï¼šä½¿ç”¨ OPENROWSETï¼ˆæ— éœ€æå‰åˆ›å»º Linked Serverï¼‰
ä¸€æ¬¡æ€§æŸ¥è¯¢ï¼š

sql
SELECT *
FROM OPENROWSET(
'SQLNCLI',
'Server=192.168.1.1,1345;UID=sa;PWD=yourpassword;',
'SELECT * FROM database1.dbo.table1'
);
æ³¨æ„ï¼šéœ€è¦å¼€å¯ Ad Hoc Distributed Queriesã€‚

ğŸ¯ æ€»ç»“ï¼šSQL Server è·¨æœºå™¨æŸ¥è¯¢çš„æ­£ç¡®æ–¹å¼
æ–¹æ³•	æ˜¯å¦éœ€è¦é…ç½®	é€‚ç”¨åœºæ™¯
Linked Server	éœ€è¦	æœ€å¸¸ç”¨ã€æœ€ç¨³å®šã€æ”¯æŒè·¨åº“ JOIN
OPENQUERY	éœ€è¦ Linked Server	å¤æ‚ SQL
OPENROWSET	ä¸éœ€è¦	ä¸´æ—¶æŸ¥è¯¢ã€ä¸€æ¬¡æ€§ä»»åŠ¡



ğŸ§© 2. Linked Server åœ¨ SSMS çš„ä½ç½®ä¸æ˜æ˜¾
å®ƒä¸åœ¨â€œæ•°æ®åº“â€ä¸‹é¢ï¼Œè€Œæ˜¯åœ¨ï¼š

Code
æœåŠ¡å™¨å¯¹è±¡ï¼ˆServer Objectsï¼‰
â””â”€â”€ é“¾æ¥æœåŠ¡å™¨ï¼ˆLinked Serversï¼‰


æ€»ç»“ï¼šä¸ºä»€ä¹ˆ Linked Server ä¸èƒ½åšåˆ†å¸ƒå¼åˆ†é¡µï¼Ÿ
å› ä¸ºï¼š

æŸ¥è¯¢æ–¹å¼	ORDER BY / TOP æ˜¯å¦ä¸‹æ¨	æ€§èƒ½
ç›´æ¥æŸ¥è¯¢ Linked Server	âŒ ä¸ä¸‹æ¨	æå·®
OPENQUERY	âœ” ä¸‹æ¨	å¯æ¥å—
çœŸæ­£çš„åˆ†å¸ƒå¼æ•°æ®åº“ï¼ˆShardingSphere / MyCATï¼‰	âœ” è‡ªåŠ¨ä¸‹æ¨ + è‡ªåŠ¨åˆå¹¶	æœ€ä½³
ğŸ”¥ ä¸ºä»€ä¹ˆ Linked Server ä»ç„¶ä¸èƒ½æ›¿ä»£åˆ†å¸ƒå¼æ•°æ®åº“ï¼Ÿ
å³ä½¿ä½ ç”¨ OPENQUERY ä¸‹æ¨åˆ†é¡µï¼Œä»ç„¶æœ‰è‡´å‘½é—®é¢˜ï¼š

æ— æ³•è‡ªåŠ¨è·¯ç”±ï¼ˆä½ å¿…é¡»è‡ªå·±å†™åˆ†ç‰‡é€»è¾‘ï¼‰

